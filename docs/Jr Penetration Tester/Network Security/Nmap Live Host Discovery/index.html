<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Jr Penetration Tester/Network Security/Nmap Live Host Discovery" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.0">
<title data-rh="true">Nmap Live Host Discovery | THM Notes</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://thm.pochacco.top/img/Pochacco-social-card.png"><meta data-rh="true" name="twitter:image" content="https://thm.pochacco.top/img/Pochacco-social-card.png"><meta data-rh="true" property="og:url" content="https://thm.pochacco.top/docs/Jr Penetration Tester/Network Security/Nmap Live Host Discovery"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Nmap Live Host Discovery | THM Notes"><meta data-rh="true" name="description" content="Nmap #tools"><meta data-rh="true" property="og:description" content="Nmap #tools"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://thm.pochacco.top/docs/Jr Penetration Tester/Network Security/Nmap Live Host Discovery"><link data-rh="true" rel="alternate" href="https://thm.pochacco.top/docs/Jr Penetration Tester/Network Security/Nmap Live Host Discovery" hreflang="en"><link data-rh="true" rel="alternate" href="https://thm.pochacco.top/docs/Jr Penetration Tester/Network Security/Nmap Live Host Discovery" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.487c242f.css">
<script src="/assets/js/runtime~main.32f33024.js" defer="defer"></script>
<script src="/assets/js/main.7573ae7a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="PochaccoTop Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.png" alt="PochaccoTop Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">TryHackMe Notes</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Intro">TryHackme</a></div><div class="navbar__items navbar__items--right"><a href="https://index.pochacco.top/en/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Index<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://pochacco.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">MainSite<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/pikachu233666" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Intro">TryHackMe</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Introduction to Cyber Security/Introduction to Cyber Security/Careers in Cyber">Introduction to Cyber Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Introduction to Cyber Security/Introduction to Cyber Security/Careers in Cyber">Pre Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Introduction to Cyber Security/Introduction to Cyber Security/Careers in Cyber">Jr Penetration Tester</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Introduction to Cyber Security/Introduction to Cyber Security/Careers in Cyber">Introduction to Cyber Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Jr Penetration Tester/Introduction to Pentesting/Pentesting Fundamentals">Introduction to Pentesting</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Jr Penetration Tester/Introduction to Web Hacking/Authentication Bypass">Introduction to Web Hacking</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Jr Penetration Tester/Burp Suite/Extensions">Burp Suite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Active Reconnaissance">Network Security</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Active Reconnaissance">Active Reconnaissance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Nmap Advanced Port Scans">Nmap Advanced Port Scans</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Nmap Basic Port Scans">Nmap Basic Port Scans</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Nmap Live Host Discovery">Nmap Live Host Discovery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Nmap Post Port Scans">Nmap Post Port Scans</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Passive Reconnaissance">Passive Reconnaissance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Protocols and Servers 2">Protocols and Servers 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Jr Penetration Tester/Network Security/Protocols and Servers">Protocols and Servers</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Jr Penetration Tester/Vulnerability Research/Exploit Vulnerabilities">Vulnerability Research</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Jr Penetration Tester/Metasploit/Exploitation">Metasploit</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/Jr Penetration Tester/Privilege Escalation/Linux Privilege Escalation">Privilege Escalation</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Events/The Witch&#x27;s Cauldron">Events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Others/Bash Scripting">Others</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Jr Penetration Tester</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Network Security</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Nmap Live Host Discovery</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p>#Network #Nmap #tools</p>
<p>Nmap, short for Network Mapper, is an industry-standard tool for mapping networks, identifying live hosts, and discovering running services</p>
<p>Three different ways that Nmap uses to discover live hosts</p>
<ul>
<li>ARP scan</li>
<li>ICMP scan</li>
<li>TCP/ UDP ping scan</li>
</ul>
<p>Two canners</p>
<ul>
<li>arp-scan</li>
<li>masscan</li>
</ul>
<p>A Nmap scan usually goes through the steps
<img decoding="async" loading="lazy" alt="Steps" src="/assets/images/Nmap_Live_Host_Discovery_1-5e5a5d30f80b934d0557fc86943963fd.png" width="642" height="802" class="img_ev3q"></p>
<p>Nmap Live Host Discovery include three steps</p>
<ol>
<li>Enumerate targets</li>
<li>Discover live hosts</li>
<li>Reverse-DNS lookup</li>
</ol>
<h1>Subnetworks</h1>
<p>A <em>network segment</em> is a group of computers connected using a shared medium. For instance, the medium can be the Ethernet switch or WiFi access point. In an IP network, a <em>subnetwork</em> is usually the equivalent of one or more network segments connected together and configured to use the same router. The network segment refers to a physical connection, while a subnetwork refers to a logical connection.</p>
<p>A subnetwork, or simply a subnet, has its own IP address range and is connected to a more extensive network via a router.
<img decoding="async" loading="lazy" alt="Subnet" src="/assets/images/Nmap_Live_Host_Discovery_2-ed076a1ccc8d752600a34ac982f41bf1.png" width="1400" height="1400" class="img_ev3q"></p>
<p>There are two types of subnets</p>
<ul>
<li>Subnets with <code>/16</code>, which means that the subnet mask can be written as <code>255.255.0.0</code>. This subnet can have around 65 thousand hosts.</li>
<li>Subnets with <code>/24</code>, which indicates that the subnet mask can be expressed as <code>255.255.255.0</code>. This subnet can have around 250 hosts.</li>
</ul>
<p>As part of active reconnaissance, we want to discover more information about a group of hosts or about a subnet. If you are connected to the same subnet, you would expect your scanner to rely on ARP (Address Resolution Protocol) queries to discover live hosts. An ARP query aims to get the hardware address (MAC address) so that communication over the link-layer becomes possible; however, we can use this to infer that the host is online.</p>
<p>If you are in Network A, you can use ARP only to discover the devices within that subnet (10.1.100.0/24). Suppose you are connected to a subnet different from the subnet of the target system(s). In that case, all packets generated by your scanner will be routed via the default gateway (router) to reach the systems on another subnet; however, the ARP queries won’t be routed and hence cannot cross the subnet router. ARP is a link-layer protocol, and ARP packets are bound to their subnet.</p>
<h1>Enumerating Targets</h1>
<p>Example of target specification</p>
<ul>
<li>list: <code>MACHINE_IP scanme.nmap.org example.com</code> will scan 3 IP addresses.</li>
<li>range: <code>10.11.12.15-20</code> will scan 6 IP addresses: <code>10.11.12.15</code>, <code>10.11.12.16</code>,… and <code>10.11.12.20</code>.</li>
<li>subnet: <code>MACHINE_IP/30</code> will scan 4 IP addresses.
You can also provide a file as input for your list of targets, <code>nmap -iL list_of_hosts.txt</code>.</li>
</ul>
<p>If you want to check the list of hosts that Nmap will scan, you can use <code>nmap -sL TARGETS</code>. This option will give you a detailed list of the hosts that Nmap will scan without scanning them; however, Nmap will attempt a reverse-DNS resolution on all the targets to obtain their names. Names might reveal various information to the pentester. (If you don’t want Nmap to the DNS server, you can add <code>-n</code>.)</p>
<h1>Discovering Live Hosts</h1>
<p>We will leverage the protocols to discover the live hosts. Starting from bottom to top, we can use</p>
<ul>
<li>ARP from Link Layer</li>
<li>ICMP from Network Layer</li>
<li>TCP from Transport Layer</li>
<li>UDP from Transport Layer</li>
</ul>
<p><img decoding="async" loading="lazy" alt="TCP/ IP Layer" src="/assets/images/Nmap_Live_Host_Discovery_3-05f1abf0d62701df09ce7a5da8ce3c64.png" width="984" height="664" class="img_ev3q"></p>
<p>ARP: only has one purpose, sending a frame to the broadcast address on the network segment and asking the computer with a specific IP address to respond by providing its MAC (hardware) address.</p>
<p>ICMP has <a href="https://www.iana.org/assignments/icmp-parameters/icmp-parameters.xhtml" target="_blank" rel="noopener noreferrer">many types</a>. ICMP ping uses Type 8 (Echo) and Type 0 (Echo Reply).</p>
<p>If you want to ping a system on the same subnet, an ARP query should precede the ICMP Echo.</p>
<p>Although TCP and UDP are transport layers, for network scanning purposes, a scanner can send a specially-crafted packet to common TCP or UDP ports to check whether the target will respond. This method is efficient, especially when ICMP Echo is blocked.</p>
<h1>Using APR</h1>
<p>There are various ways to discover online hosts. When no host discovery options are provided, Nmap follows the following approaches to discover live hosts</p>
<ol>
<li>When a <em>privileged</em> user tries to scan targets on a local network (Ethernet), Nmap uses <em>ARP requests</em>. A privileged user is <code>root</code> or a user who belongs to <code>sudoers</code> and can run <code>sudo</code>.</li>
<li>When a <em>privileged</em> user tries to scan targets outside the local network, Nmap uses ICMP echo requests, TCP ACK (Acknowledge) to port 80, TCP SYN (Synchronize) to port 443, and ICMP timestamp request.</li>
<li>When an <em>unprivileged</em> user tries to scan targets outside the local network, Nmap resorts to a TCP 3-way handshake by sending SYN packets to ports 80 and 443.</li>
</ol>
<p>Nmap, by default, uses a ping scan to find live hosts, then proceeds to scan live hosts only. If you want to use Nmap to discover online hosts without port-scanning the live systems, you can issue <code>nmap -sn TARGETS</code>.</p>
<p><img decoding="async" loading="lazy" alt="ARP" src="/assets/images/Nmap_Live_Host_Discovery_4-d688b08c9b5f3f39fa3015491ebcd4c5.png" width="862" height="260" class="img_ev3q"></p>
<p>ARP scan is possible only if you are on the same subnet as the target systems. On an Ethernet (802.3) and WiFi (802.11), you need to know the MAC address of any system before you can communicate with it. The MAC address is necessary for the link-layer header; the header contains the source MAC address and the destination MAC address among other fields. To get the MAC address, the OS sends an ARP query. A host that replies to ARP queries is up. The ARP query only works if the target is on the same subnet as yourself.</p>
<p>If you want Nmap only to perform an ARP scan without port-scanning, you can use <code>nmap -PR -sn TARGETS</code>, where <code>-PR</code> indicates that you only want an ARP scan. We run <code>nmap -PR -sn MACHINE_IP/24</code> to discover all the live systems on the same subnet as our target machine.</p>
<p>For <code>arp-scan</code> , one popular choice is <code>arp-scan --localnet</code> or simply <code>arp-scan -l</code>. This command will send ARP queries to all valid IP addresses on your local networks. You can specify the interface using <code>-I</code>. For instance, <code>sudo arp-scan -I eth0 -l</code> will send ARP queries for all valid IP addresses on the <code>eth0</code> interface.</p>
<h1>Using ICMP</h1>
<p>We can ping every IP address on a target network and see who would respond to our <code>ping</code> (ICMP Type 8/Echo) requests with a ping reply (ICMP Type 0).</p>
<p>An ARP query will precede the ICMP request if your target is on the same subnet.</p>
<p><img decoding="async" loading="lazy" alt="ICMP Echo" src="/assets/images/Nmap_Live_Host_Discovery_5-bd1c0d3db98342ff3fe2ba0162b9a6ae.png" width="862" height="260" class="img_ev3q"></p>
<p>To use ICMP echo request to discover live hosts, add the option <code>-PE</code>. (Remember to add <code>-sn</code> if you don’t want to follow that with a port scan.)</p>
<p>we scanned the target’s subnet using <code>nmap -PE -sn MACHINE_IP/24</code>. Many firewalls block ICMP.</p>
<p>Because ICMP echo requests tend to be blocked, you might also consider ICMP Timestamp or ICMP Address Mask requests to tell if a system is online. Nmap uses timestamp request (ICMP Type 13) and checks whether it will get a Timestamp reply (ICMP Type 14). Adding the <code>-PP</code> option tells Nmap to use ICMP timestamp requests. We run <code>nmap -PP -sn MACHINE_IP/24</code></p>
<p><img decoding="async" loading="lazy" alt="ICMP TImestamp" src="/assets/images/Nmap_Live_Host_Discovery_6-2a6a71d1f4d0b81ddc08cd647f1d2643.png" width="862" height="260" class="img_ev3q"></p>
<p>Nmap uses address mask queries (ICMP Type 17) and checks whether it gets an address mask reply (ICMP Type 18). This scan can be enabled with the option <code>-PM</code>. We run the command <code>nmap -PM -sn MACHINE_IP/24</code>.</p>
<p><img decoding="async" loading="lazy" alt="ICMP AMP" src="/assets/images/Nmap_Live_Host_Discovery_7-fe785182db569f797dcc90fe02345566.png" width="862" height="260" class="img_ev3q"></p>
<h1>Using TCP and UDP</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-syn-ping">TCP SYN Ping<a href="#tcp-syn-ping" class="hash-link" aria-label="Direct link to TCP SYN Ping" title="Direct link to TCP SYN Ping">​</a></h2>
<p>We can send a packet with the SYN (Synchronize) flag set to a TCP port, 80 by default, and wait for a response. An open port should reply with a SYN/ACK (Acknowledge); a closed port would result in an RST (Reset).</p>
<p><img decoding="async" loading="lazy" alt="TCP Handshake" src="/assets/images/Nmap_Live_Host_Discovery_8-6b39c852e7bdac92176d737188f0ad5a.png" width="862" height="320" class="img_ev3q"></p>
<p>Privileged users (root and sudoers) can send TCP SYN packets and don’t need to complete the TCP 3-way handshake even if the port is open, as shown in the figure below. Unprivileged users have no choice but to complete the 3-way handshake if the port is open. We will run <code>nmap -PS -sn MACHINE_IP/24</code>.</p>
<p><img decoding="async" loading="lazy" alt="TCP SYN" src="/assets/images/Nmap_Live_Host_Discovery_9-05b1b291a5cc14946b4c86f7dae4b316.png" width="862" height="320" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tcp-ack-ping">TCP ACK Ping<a href="#tcp-ack-ping" class="hash-link" aria-label="Direct link to TCP ACK Ping" title="Direct link to TCP ACK Ping">​</a></h2>
<p>It sends a packet with an ACK flag set. You must be running Nmap as a privileged user to be able to accomplish this. By default, port 80 is used. We run <code>sudo nmap -PA -sn MACHINE_IP/24</code></p>
<p>Any TCP packet with an ACK flag should get a TCP packet back with an RST flag set. The target responds with the RST flag set because the TCP packet with the ACK flag is not part of any ongoing connection. The expected response is used to detect if the target host is up.</p>
<p><img decoding="async" loading="lazy" alt="TCP ACK" src="/assets/images/Nmap_Live_Host_Discovery_10-df92af512969dbda5107f30e825550b3.png" width="862" height="260" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="udp-ping">UDP Ping<a href="#udp-ping" class="hash-link" aria-label="Direct link to UDP Ping" title="Direct link to UDP Ping">​</a></h2>
<p>We can use UDP to discover if the host is online. Contrary to TCP SYN ping, sending a UDP packet to an open port is not expected to lead to any reply. However, if we send a UDP packet to a closed UDP port, we expect to get an ICMP port unreachable packet; this indicates that the target system is up and available. Nmap uses <code>-PU</code> for UDP ping</p>
<p><img decoding="async" loading="lazy" alt="UDP up" src="/assets/images/Nmap_Live_Host_Discovery_11-e33d5eda5a8bd3aa21eef8776871c02e.png" width="862" height="240" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="UDP Down" src="/assets/images/Nmap_Live_Host_Discovery_12-35138310a2914b207aaeb86d718b877f.png" width="862" height="280" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="masscan">Masscan<a href="#masscan" class="hash-link" aria-label="Direct link to Masscan" title="Direct link to Masscan">​</a></h2>
<p>Masscan uses a similar approach to discover the available systems. However, to finish its network scan quickly, Masscan is quite aggressive with the rate of packets it generates.</p>
<ul>
<li><code>masscan MACHINE_IP/24 -p443</code></li>
<li><code>masscan MACHINE_IP/24 -p80,443</code></li>
<li><code>masscan MACHINE_IP/24 -p22-25</code></li>
<li><code>masscan MACHINE_IP/24 ‐‐top-ports 100</code></li>
</ul>
<h1>Using Reverse-DNS Lookup</h1>
<p>Nmap’s default behaviour is to use reverse-DNS online hosts. Because the hostnames can reveal a lot, this can be a helpful step. However, if you don’t want to send such DNS queries, you use <code>-n</code> to skip this step.</p>
<p>By default, Nmap will look up online hosts; however, you can use the option <code>-R</code> to query the DNS server even for offline hosts. If you want to use a specific DNS server, you can add the <code>--dns-servers DNS_SERVER</code> option.</p>
<h1>Summary</h1>
<table><thead><tr><th style="text-align:center">Scan Type</th><th style="text-align:center">Example Command</th></tr></thead><tbody><tr><td style="text-align:center">ARP Scan</td><td style="text-align:center"><code>sudo nmap -PR -sn MACHINE_IP/24</code></td></tr><tr><td style="text-align:center">ICMP Echo Scan</td><td style="text-align:center"><code>sudo nmap -PE -sn MACHINE_IP/24</code></td></tr><tr><td style="text-align:center">ICMP Timestamp Scan</td><td style="text-align:center"><code>sudo nmap -PP -sn MACHINE_IP/24</code></td></tr><tr><td style="text-align:center">ICMP Address Mask Scan</td><td style="text-align:center"><code>sudo nmap -PM -sn MACHINE_IP/24</code></td></tr><tr><td style="text-align:center">TCP SYN Ping Scan</td><td style="text-align:center"><code>sudo nmap -PS22,80,443 -sn MACHINE_IP/30</code></td></tr><tr><td style="text-align:center">TCP ACK Ping Scan</td><td style="text-align:center"><code>sudo nmap -PA22,80,443 -sn MACHINE_IP/30</code></td></tr><tr><td style="text-align:center">UDP Ping Scan</td><td style="text-align:center"><code>sudo nmap -PU53,161,162 -sn MACHINE_IP/30</code></td></tr></tbody></table>
<table><thead><tr><th style="text-align:center">Option</th><th style="text-align:center">Purpose</th></tr></thead><tbody><tr><td style="text-align:center"><code>-n</code></td><td style="text-align:center">no DNS lookup</td></tr><tr><td style="text-align:center"><code>-R</code></td><td style="text-align:center">reverse-DNS lookup for all hosts</td></tr><tr><td style="text-align:center"><code>-sn</code></td><td style="text-align:center">host discovery only</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Jr Penetration Tester/Network Security/Nmap Basic Port Scans"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Nmap Basic Port Scans</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Jr Penetration Tester/Network Security/Nmap Post Port Scans"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Nmap Post Port Scans</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tcp-syn-ping" class="table-of-contents__link toc-highlight">TCP SYN Ping</a></li><li><a href="#tcp-ack-ping" class="table-of-contents__link toc-highlight">TCP ACK Ping</a></li><li><a href="#udp-ping" class="table-of-contents__link toc-highlight">UDP Ping</a></li><li><a href="#masscan" class="table-of-contents__link toc-highlight">Masscan</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Gabriel@pochacco.top</div></div></div></footer></div>
</body>
</html>