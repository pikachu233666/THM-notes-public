"use strict";(self.webpackChunkTHM_Notes=self.webpackChunkTHM_Notes||[]).push([[502],{4144:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=n(4848),i=n(8453);const r={},a="Sniffing Attack",o={id:"Jr Penetration Tester/Network Security/Protocols and Servers 2",title:"Protocols and Servers 2",description:"Concept",source:"@site/docs/Jr Penetration Tester/Network Security/Protocols and Servers 2.md",sourceDirName:"Jr Penetration Tester/Network Security",slug:"/Jr Penetration Tester/Network Security/Protocols and Servers 2",permalink:"/docs/Jr Penetration Tester/Network Security/Protocols and Servers 2",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"THMSidebar",previous:{title:"Passive Reconnaissance",permalink:"/docs/Jr Penetration Tester/Network Security/Passive Reconnaissance"},next:{title:"Protocols and Servers",permalink:"/docs/Jr Penetration Tester/Network Security/Protocols and Servers"}},c={},d=[];function h(e){const t={a:"a",code:"code",em:"em",h1:"h1",img:"img",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:"#Network #Concept"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Sniffing Attack (Network Packet Capture)"}),"\n",(0,s.jsx)(t.li,{children:"Man-in-the-Middle (MITM) Attack"}),"\n",(0,s.jsx)(t.li,{children:"Password Attack (Authentication Attack)"}),"\n",(0,s.jsx)(t.li,{children:"Vulnerabilities"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["From a security perspective, we always need to think about what we aim to protect; consider the security triad: Confidentiality, Integrity, and Availability (CIA). ",(0,s.jsx)(t.strong,{children:"Confidentiality"})," refers to keeping the contents of the communications accessible to the intended parties. ",(0,s.jsx)(t.strong,{children:"Integrity"})," is the idea of assuring any data sent is accurate, consistent, and complete when reaching its destination. Finally, ",(0,s.jsx)(t.strong,{children:"availability"})," refers to being able to access the service when we need it. Different parties will put varying emphasis on these three. For instance, confidentiality would be the highest priority for an intelligence agency. Online banking will put most emphasis on the integrity of transactions. Availability is of the highest importance for any platform making money by serving ads."]}),"\n",(0,s.jsx)(t.p,{children:"Knowing that we are protecting the Confidentiality, Integrity, and Availability (CIA), an attack aims to cause Disclosure, Alteration, and Destruction (DAD). The figures below reflect this."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"CIA",src:n(4693).A+"",width:"1302",height:"442"})}),"\n",(0,s.jsx)(t.p,{children:"These attacks directly affect the security of the system. For instance, network packet capture violates confidentiality and leads to the disclosure of information. A successful password attack can also lead to disclosure. On the other hand, a Man-in-the-Middle (MITM) attack breaks the system\u2019s integrity as it can alter the communicated data. These attacks are integral to the protocol design and server implementation."}),"\n",(0,s.jsx)(t.p,{children:"Vulnerabilities are of a broader spectrum, and exploited vulnerabilities have different impacts on the target systems. For instance, exploiting a Denial of Service (DoS) vulnerability can affect the system\u2019s availability, while exploiting a Remote Code Execution (RCE) vulnerability can lead to more severe damages. It is important to note that a vulnerability by itself creates a risk; damage can occur only when the vulnerability is exploited."}),"\n",(0,s.jsx)(t.h1,{id:"sniffing-attack",children:"Sniffing Attack"}),"\n",(0,s.jsx)(t.p,{children:"Sniffing attack refers to using a network packet capture tool to collect information about the target. When a protocol communicates in cleartext, the data exchanged can be captured by a third party to analyse.\xa0A simple network packet capture can reveal information, such as the content of private messages and login credentials, if the data isn't encrypted in transit."}),"\n",(0,s.jsx)(t.p,{children:"A sniffing attack can be conducted using an Ethernet (802.3) network card, provided that the user has proper permissions (root permissions on Linux and administrator privileges on MS Windows). There are many programs available to capture network packets. We consider the following"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Tcpdump"})," is a free open source command-line interface (CLI) program that has been ported to work on many operating systems."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Wireshark"})," is a free open source graphical user interface (GUI) program available for several operating systems, including Linux, macOS and MS Windows."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Tshark"}),"\xa0is a CLI alternative to Wireshark."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Consider a user checking his email messages using POP3. First, we are going to use Tcpdump to attempt to capture the username and password. In the terminal output below, we used the command ",(0,s.jsx)(t.code,{children:"sudo tcpdump port 110 -A"}),". Before explaining this command, we should mention that this attack requires access to the network traffic, for example, via a wiretap or a switch with port mirroring. Alternatively, we can access the traffic exchanged if we launch a successful Man-in-the-Middle (MITM) attack."]}),"\n",(0,s.jsxs)(t.p,{children:["We need ",(0,s.jsx)(t.code,{children:"sudo"})," as packet captures require root privileges. We wanted to limit the number of captured and displayed packets to those exchanged with the POP3 server. We know that POP3 uses port 110, so we filtered our packets using ",(0,s.jsx)(t.code,{children:"port 110"}),". Finally, we wanted to display the contents of the captured packets in ASCII format, so we added ",(0,s.jsx)(t.code,{children:"-A"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"In brief, any protocol that uses cleartext communication is susceptible to this kind of attack. The only requirement for this attack to succeed is to have access to a system between the two communicating systems. This attack requires attention; the mitigation lies in adding an encryption layer on top of any network protocol. In particular, Transport Layer Security (TLS) has been added to HTTP, FTP, SMTP, POP3, IMAP and many others. For remote access, Telnet has been replaced by the secure alternative Secure Shell (SSH)."}),"\n",(0,s.jsx)(t.h1,{id:"man-in-the-middle-mitm-attack",children:"Man-in-the-Middle (MITM) Attack"}),"\n",(0,s.jsx)(t.p,{children:"A Man-in-the-Middle (MITM) attack occurs when a victim (A) believes they are communicating with a legitimate destination (B) but is unknowingly communicating with an attacker (E). In the figure below, we have A requesting the transfer of $20 to M; however, E altered this message and replaced the original value with a new one. B received the modified messaged and acted on it."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"MITM",src:n(2894).A+"",width:"882",height:"562"})}),"\n",(0,s.jsx)(t.p,{children:"This attack is relatively simple to carry out if the two parties do not confirm the authenticity and integrity of each message. In some cases, the chosen protocol does not provide secure authentication or integrity checking; moreover, some protocols have inherent insecurities that make them susceptible to this kind of attack."}),"\n",(0,s.jsxs)(t.p,{children:["Any time you browse over HTTP, you are susceptible to a MITM attack, and the scary thing is that you cannot recognize it. Many tools would aid you in carrying out such an attack, such as ",(0,s.jsx)(t.a,{href:"https://www.ettercap-project.org",children:"Ettercap"})," and ",(0,s.jsx)(t.a,{href:"https://www.bettercap.org",children:"Bettercap"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"MITM can also affect other cleartext protocols such as FTP, SMTP, and POP3. Mitigation against this attack requires the use of cryptography. The solution lies in proper authentication along with encryption or signing of the exchanged messages. With the help of Public Key Infrastructure (PKI) and trusted root certificates, Transport Layer Security (TLS) protects from MITM attacks."}),"\n",(0,s.jsx)(t.h1,{id:"transport-layer-security-tls",children:"Transport Layer Security (TLS)"}),"\n",(0,s.jsx)(t.p,{children:"TLS is a standard solution to protect the confidentiality and integrity of the exchanged packets. The following approach can protect against password sniffing and MITM attacks."}),"\n",(0,s.jsx)(t.p,{children:"SSL (Secure Sockets Layer) started when the world wide web started to see new applications, such as online shopping and sending payment information. Netscape introduced SSL in 1994, with SSL 3.0 being released in 1996."}),"\n",(0,s.jsx)(t.p,{children:"The common protocols we have covered so far send the data in cleartext; this makes it possible for anyone with access to the network to capture, save and analyze the exchanged messages. The image below shows the ISO/OSI network layers. The protocols covered so far are on the application layer. Consider the ISO/OSI model; we can add encryption to our protocols via the presentation layer. Consequently, data will be presented in an encrypted format (ciphertext) instead of its original form."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"OSI",src:n(5911).A+"",width:"802",height:"642"})}),"\n",(0,s.jsx)(t.p,{children:"Because of the close relation between SSL and TLS, one might be used instead of the other. However, TLS is more secure than SSL, and it has practically replaced SSL. We could have dropped SSL and just written TLS instead of SSL/TLS, but we will continue to mention the two to avoid any ambiguity because the term SSL is still in wide use. However, we can expect all modern servers to be using TLS."}),"\n",(0,s.jsx)(t.p,{children:"An existing cleartext protocol can be upgraded to use encryption via SSL/TLS. We can use TLS to upgrade HTTP, FTP, SMTP, POP3, and IMAP, to name a few. The following table lists the protocols we have covered and their default ports before and after the encryption upgrade via SSL/TLS. The list is not exhaustive; however, the purpose is to help us better understand the process."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Protocol"}),(0,s.jsx)(t.th,{children:"Default Port"}),(0,s.jsx)(t.th,{children:"Secured Protocol"}),(0,s.jsx)(t.th,{children:"Default Port with TLS"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"HTTP"}),(0,s.jsx)(t.td,{children:"80"}),(0,s.jsx)(t.td,{children:"HTTPS"}),(0,s.jsx)(t.td,{children:"443"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"FTP"}),(0,s.jsx)(t.td,{children:"21"}),(0,s.jsx)(t.td,{children:"FTPS"}),(0,s.jsx)(t.td,{children:"990"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"SMTP"}),(0,s.jsx)(t.td,{children:"25"}),(0,s.jsx)(t.td,{children:"SMTPS"}),(0,s.jsx)(t.td,{children:"465"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"POP3"}),(0,s.jsx)(t.td,{children:"110"}),(0,s.jsx)(t.td,{children:"POP3S"}),(0,s.jsx)(t.td,{children:"995"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"IMAP"}),(0,s.jsx)(t.td,{children:"143"}),(0,s.jsx)(t.td,{children:"IMAPS"}),(0,s.jsx)(t.td,{children:"993"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"Considering the case of HTTP. Initially, to retrieve a web page over HTTP, the web browser would need at least perform the following two steps"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Establish a TCP connection with the remote web server"}),"\n",(0,s.jsxs)(t.li,{children:["Send HTTP requests to the web server, such as ",(0,s.jsx)(t.code,{children:"GET"})," and ",(0,s.jsx)(t.code,{children:"POST"})," requests."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"HTTPS requires an additional step to encrypt the traffic. The new step takes place after establishing a TCP connection and before sending HTTP requests. This extra step can be inferred from the ISO/OSI model in the image presented earlier. Consequently, HTTPS requires at least the following three steps"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Establish a TCP connection"}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.strong,{children:"Establish SSL/TLS connection"})}),"\n",(0,s.jsx)(t.li,{children:"Send HTTP requests to the webserver"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["To establish an SSL/TLS connection, the client needs to perform the proper handshake with the server. Based on ",(0,s.jsx)(t.a,{href:"https://datatracker.ietf.org/doc/html/rfc6101",children:"RFC 6101"}),", the SSL connection establishment will look like the figure below."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"SSL",src:n(4392).A+"",width:"882",height:"516"})}),"\n",(0,s.jsx)(t.p,{children:"After establishing a TCP connection with the server, the client establishes an SSL/TLS connection, as shown in the figure above. The terms might look complicated depending on your knowledge of cryptography, but we can simplify the four steps as"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"The client sends a ClientHello to the server to indicate its capabilities, such as supported algorithms."}),"\n",(0,s.jsx)(t.li,{children:"The server responds with a ServerHello, indicating the selected connection parameters. The server provides its certificate if server authentication is required. The certificate is a digital file to identify itself; it is usually digitally signed by a third party. Moreover, it might send additional information necessary to generate the master key, in its ServerKeyExchange message, before sending the ServerHelloDone message to indicate that it is done with the negotiation."}),"\n",(0,s.jsx)(t.li,{children:"The client responds with a ClientKeyExchange, which contains additional information required to generate the master key. Furthermore, it switches to use encryption and informs the server using the ChangeCipherSpec message."}),"\n",(0,s.jsx)(t.li,{children:"The server switches to use encryption as well and informs the client in the ChangeCipherSpec message."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"A client was able to agree on a secret key with a server that has a public certificate. This secret key was securely generated so that a third party monitoring the channel wouldn\u2019t be able to discover it. Further communication between the client and the server will be encrypted using the generated key."}),"\n",(0,s.jsx)(t.p,{children:"Consequently, once an SSL/TLS handshake has been established, HTTP requests and exchanged data won\u2019t be accessible to anyone watching the communication channel."}),"\n",(0,s.jsxs)(t.p,{children:["As a final note, for SSL/TLS to be effective, especially when browsing the web over HTTPS, we rely on public certificates signed by certificate authorities trusted by our systems. In other words, when we browse to ",(0,s.jsx)(t.a,{href:"https://tryhackme.com/",children:"TryHackMe"})," over HTTPS, our browser expects the TryHackMe web server to provide a signed certificate from a trusted certificate authority. This way, our browser ensures that it is communicating with the correct server, and a MITM attack cannot occur."]}),"\n",(0,s.jsx)(t.h1,{id:"secure-shell-ssh",children:"Secure Shell (SSH)"}),"\n",(0,s.jsx)(t.p,{children:"Secure Shell (SSH) was created to provide a secure way for remote system administration. In other words, it lets you securely connect to another system over the network and execute commands on the remote system. Put simply, the \u201cS\u201d in SSH stands for secure, which can be summarized simply as"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"You can confirm the identity of the remote server"}),"\n",(0,s.jsx)(t.li,{children:"Exchanged messages are encrypted and can only be decrypted by the intended recipient"}),"\n",(0,s.jsx)(t.li,{children:"Both sides can detect any modification in the messages"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The above three points are ensured by cryptography. In more technical terms, they are part of confidentiality and integrity, made possible through the proper use of different encryption algorithms."}),"\n",(0,s.jsx)(t.p,{children:"To use SSH, you need an SSH server and an SSH client. The SSH server listens on port 22 by default. The SSH client can authenticate using"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"A username and a password"}),"\n",(0,s.jsx)(t.li,{children:"A private and public key (after the SSH server is configured to recognize the corresponding public key)"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"ssh username@IP"})}),"\n",(0,s.jsx)(t.p,{children:"SSH is very reliable for remote administration because our username and password were sent encrypted; moreover, all commands we execute on the remote system will be sent over an encrypted channel."}),"\n",(0,s.jsx)(t.p,{children:"Note that if this is the first time we connect to this system, we will need to confirm the fingerprint of the SSH server\u2019s public key to avoid man-in-the-middle (MITM) attacks. As explained earlier, MITM takes place when a malicious party, E, situates itself between A and B, and communicates with A, pretending to be B, and communicates with B pretending to be A, while A and B think that they are communicating directly with each other. In the case of SSH, we don\u2019t usually have a third party to check if the public key is valid, so we need to do this manually. This attack is shown in the image below."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"MITM",src:n(9009).A+"",width:"882",height:"562"})}),"\n",(0,s.jsxs)(t.p,{children:["We can use SSH to transfer files using SCP (Secure Copy Protocol) based on the SSH protocol. An example of the syntax is as follows: ",(0,s.jsx)(t.code,{children:"scp mark@10.10.82.90:/home/mark/archive.tar.gz ~"}),". This command will copy a file named ",(0,s.jsx)(t.code,{children:"archive.tar.gz"})," from the remote system located in the ",(0,s.jsx)(t.code,{children:"/home/mark"})," directory to ",(0,s.jsx)(t.code,{children:"~"}),", i.e., the root of the home directory of the currently logged-in user."]}),"\n",(0,s.jsxs)(t.p,{children:["Another example syntax is ",(0,s.jsx)(t.code,{children:"scp backup.tar.bz2 mark@10.10.82.90:/home/mark/"}),". This command will copy the file ",(0,s.jsx)(t.code,{children:"backup.tar.bz2"})," from the local system to the directory\xa0",(0,s.jsx)(t.code,{children:"/home/mark/"})," on the remote system."]}),"\n",(0,s.jsx)(t.p,{children:"As a closing note, FTP could be secured using SSL/TLS by using the FTPS protocol which uses port 990. It is worth mentioning that FTP can also be secured using the SSH protocol which is the SFTP protocol. By default this service listens on port 22, just like SSH."}),"\n",(0,s.jsx)(t.h1,{id:"password-attack",children:"Password Attack"}),"\n",(0,s.jsx)(t.p,{children:"Many protocols require you to authenticate. Authentication is proving who you claim to be. When we are using protocols such as POP3, we should not be given access to the mailbox before verifying our identity. The password is one way to authentication."}),"\n",(0,s.jsx)(t.p,{children:"Authentication, or proving your identity, can be achieved through one of the following, or a combination of two"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Something you ",(0,s.jsx)(t.em,{children:"know"}),", such as password and PIN code."]}),"\n",(0,s.jsxs)(t.li,{children:["Something you ",(0,s.jsx)(t.em,{children:"have"}),", such as a SIM card, RFID card, and USB dongle."]}),"\n",(0,s.jsxs)(t.li,{children:["Something you ",(0,s.jsx)(t.em,{children:"are"}),", such as fingerprint and iris."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["This task will focus on attacks against passwords, i.e.\xa0something the target ",(0,s.jsx)(t.em,{children:"knows"}),". If you revisit the communication with several previous servers using protocols such as Telnet, SSH, POP3, and IMAP, we always need a password to gain access. Based on the 150 million usernames and passwords leaked from the Adobe breach in 2013, the top ten passwords are"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"123456"}),"\n",(0,s.jsx)(t.li,{children:"123456789"}),"\n",(0,s.jsx)(t.li,{children:"password"}),"\n",(0,s.jsx)(t.li,{children:"adobe123"}),"\n",(0,s.jsx)(t.li,{children:"12345678"}),"\n",(0,s.jsx)(t.li,{children:"qwerty"}),"\n",(0,s.jsx)(t.li,{children:"1234567"}),"\n",(0,s.jsx)(t.li,{children:"111111"}),"\n",(0,s.jsx)(t.li,{children:"photoshop"}),"\n",(0,s.jsx)(t.li,{children:"123123"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Only two passwords are related to Adobe and its products, but the rest are generic. You might think that this has changed over the past decade; however, 123456, 1234567, 12345678, and 123456789 are still common choices for many users. Others haven\u2019t realized yet that qwerty is not secret, and it is used by many as their password."}),"\n",(0,s.jsx)(t.p,{children:"Attacks against passwords are usually carried out by"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Password Guessing: Guessing a password requires some knowledge of the target, such as their pet\u2019s name and birth year."}),"\n",(0,s.jsx)(t.li,{children:"Dictionary Attack: This approach expands on password guessing and attempts to include all valid words in a dictionary or a wordlist."}),"\n",(0,s.jsx)(t.li,{children:"Brute Force Attack: This attack is the most exhaustive and time-consuming where an attacker can go as far as trying all possible character combinations, which grows fast (exponential growth with the number of characters)."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["We want an automated way to try the common passwords or the entries from a word list; here comes ",(0,s.jsx)(t.a,{href:"https://github.com/vanhauser-thc/thc-hydra",children:"THC Hydra"}),". Hydra supports many protocols, including FTP, POP3, IMAP, SMTP, SSH, and all methods related to HTTP. The general command-line syntax is: ",(0,s.jsx)(t.code,{children:"hydra -l username -P wordlist.txt server service"})," where we specify the following options"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"-l username"}),": ",(0,s.jsx)(t.code,{children:"-l"})," should precede the ",(0,s.jsx)(t.code,{children:"username"}),", i.e.\xa0the login name of the target."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"-P wordlist.txt"}),": ",(0,s.jsx)(t.code,{children:"-P"})," precedes the ",(0,s.jsx)(t.code,{children:"wordlist.txt"})," file, which is a text file containing the list of passwords you want to try with the provided username."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"server"})," is the hostname or IP address of the target server."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"service"})," indicates the service which you are trying to launch the dictionary attack."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Consider the following concrete examples"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"hydra -l mark -P /usr/share/wordlists/rockyou.txt 10.10.84.217 ftp"})," will use ",(0,s.jsx)(t.code,{children:"mark"})," as the username as it iterates over the provided passwords against the FTP server."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"hydra -l mark -P /usr/share/wordlists/rockyou.txt ftp://10.10.84.217"})," is identical to the previous example. ",(0,s.jsx)(t.code,{children:"10.10.84.217 ftp"})," is the same as ",(0,s.jsx)(t.code,{children:"ftp://10.10.84.217"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"hydra -l frank -P /usr/share/wordlists/rockyou.txt 10.10.84.217 ssh"})," will use ",(0,s.jsx)(t.code,{children:"frank"})," as the user name as it tries to login via SSH using the different passwords."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"There are some extra optional arguments that you can add"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"-s PORT"})," to specify a non-default port for the service in question."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"-V"})," or ",(0,s.jsx)(t.code,{children:"-vV"}),", for verbose, makes Hydra show the username and password combinations that are being tried. This verbosity is very convenient to see the progress, especially if you are still not confident of your command-line syntax."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"-t n"})," where n is the number of parallel connections to the target. ",(0,s.jsx)(t.code,{children:"-t 16"})," will create 16 threads used to connect to the target."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"-d"}),", for debugging, to get more detailed information about what\u2019s going on. The debugging output can save you much frustration; for instance, if Hydra tries to connect to a closed port and timing out, ",(0,s.jsx)(t.code,{children:"-d"})," will reveal this right away."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Once the password is found, you can issue ",(0,s.jsx)(t.code,{children:"CTRL-C"})," to end the process. In TryHackMe tasks, we expect any attack to finish within less than five minutes; however, the attack would usually take longer in real-life scenarios. Options for verbosity or debugging can be pretty helpful if you want Hydra to update you about its progress."]}),"\n",(0,s.jsx)(t.p,{children:"In summary, attacks against login systems can be carried out efficiently using a tool, such as THC Hydra combined with a suitable word list. Mitigation against such attacks can be sophisticated and depends on the target system. A few of the approaches include"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Password Policy: Enforces minimum complexity constraints on the passwords set by the user."}),"\n",(0,s.jsx)(t.li,{children:"Account Lockout: Locks the account after a certain number of failed attempts."}),"\n",(0,s.jsx)(t.li,{children:"Throttling Authentication Attempts: Delays the response to a login attempt. A couple of seconds of delay is tolerable for someone who knows the password, but they can severely hinder automated tools."}),"\n",(0,s.jsx)(t.li,{children:"Using CAPTCHA: Requires solving a question difficult for machines. It works well if the login page is via a graphical user interface (GUI). (Note that CAPTCHA stands for Completely Automated Public Turing test to tell Computers and Humans Apart.)"}),"\n",(0,s.jsx)(t.li,{children:"Requiring the use of a public certificate for authentication. This approach works well with SSH, for instance."}),"\n",(0,s.jsx)(t.li,{children:"Two-Factor Authentication: Ask the user to provide a code available via other means, such as email, smartphone app or SMS."}),"\n",(0,s.jsx)(t.li,{children:"There are many other approaches that are more sophisticated or might require some established knowledge about the user, such as IP-based geolocation."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Using a combination of the above approaches is an excellent approach to protect against password attacks."}),"\n",(0,s.jsx)(t.h1,{id:"summary",children:"Summary"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Protocol"}),(0,s.jsx)(t.th,{children:"TCP Port"}),(0,s.jsx)(t.th,{children:"Application(s)"}),(0,s.jsx)(t.th,{children:"Data Security"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"FTP"}),(0,s.jsx)(t.td,{children:"21"}),(0,s.jsx)(t.td,{children:"File Transfer"}),(0,s.jsx)(t.td,{children:"Cleartext"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"FTPS"}),(0,s.jsx)(t.td,{children:"990"}),(0,s.jsx)(t.td,{children:"File Transfer"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"HTTP"}),(0,s.jsx)(t.td,{children:"80"}),(0,s.jsx)(t.td,{children:"Worldwide Web"}),(0,s.jsx)(t.td,{children:"Cleartext"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"HTTPS"}),(0,s.jsx)(t.td,{children:"443"}),(0,s.jsx)(t.td,{children:"Worldwide Web"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"IMAP"}),(0,s.jsx)(t.td,{children:"143"}),(0,s.jsx)(t.td,{children:"Email (MDA)"}),(0,s.jsx)(t.td,{children:"Cleartext"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"IMAPS"}),(0,s.jsx)(t.td,{children:"993"}),(0,s.jsx)(t.td,{children:"Email (MDA)"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"POP3"}),(0,s.jsx)(t.td,{children:"110"}),(0,s.jsx)(t.td,{children:"Email (MDA)"}),(0,s.jsx)(t.td,{children:"Cleartext"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"POP3S"}),(0,s.jsx)(t.td,{children:"995"}),(0,s.jsx)(t.td,{children:"Email (MDA)"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"SFTP"}),(0,s.jsx)(t.td,{children:"22"}),(0,s.jsx)(t.td,{children:"File Transfer"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"SSH"}),(0,s.jsx)(t.td,{children:"22"}),(0,s.jsx)(t.td,{children:"Remote Access and File Transfer"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"SMTP"}),(0,s.jsx)(t.td,{children:"25"}),(0,s.jsx)(t.td,{children:"Email (MTA)"}),(0,s.jsx)(t.td,{children:"Cleartext"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"SMTPS"}),(0,s.jsx)(t.td,{children:"465"}),(0,s.jsx)(t.td,{children:"Email (MTA)"}),(0,s.jsx)(t.td,{children:"Encrypted"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Telnet"}),(0,s.jsx)(t.td,{children:"23"}),(0,s.jsx)(t.td,{children:"Remote Access"}),(0,s.jsx)(t.td,{children:"Cleartext"})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"Hydra remains a very efficient tool that you can launch from the terminal to try the different passwords. We summarize its main options in the following table."}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Option"}),(0,s.jsx)(t.th,{children:"Explanation"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"-l username"})}),(0,s.jsx)(t.td,{children:"Provide the login name"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"-P WordList.txt"})}),(0,s.jsx)(t.td,{children:"Specify the password list to use"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"server service"})}),(0,s.jsx)(t.td,{children:"Set the server address and service to attack"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"-s PORT"})}),(0,s.jsx)(t.td,{children:"Use in case of non-default service port number"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"-V"})," or ",(0,s.jsx)(t.code,{children:"-vV"})]}),(0,s.jsx)(t.td,{children:"Show the username and password combinations being tried"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"-d"})}),(0,s.jsx)(t.td,{children:"Display debugging output if the verbose output is not helping"})]})]})]})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},4693:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Protocols_and_Servers_2_1-6c5f8e23e92b88f634c1ee0d1c05d4b1.png"},2894:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Protocols_and_Servers_2_2-9b4845a1209b57ad1cf0fbec74ac7902.png"},5911:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Protocols_and_Servers_2_3-c0ad4928d4d1882cc3f2f227fb228c9e.png"},4392:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Protocols_and_Servers_2_4-b55c12526d9b4f1ccce5642abfcf75c0.png"},9009:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Protocols_and_Servers_2_5-21653c9a15adf37bf07e91d006b13986.png"},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var s=n(6540);const i={},r=s.createContext(i);function a(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);