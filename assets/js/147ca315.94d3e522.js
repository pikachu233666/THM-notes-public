"use strict";(self.webpackChunkTHM_Notes=self.webpackChunkTHM_Notes||[]).push([[5440],{3187:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>d});var n=s(4848),r=s(8453);const i={},o="Service Detection",c={id:"Jr Penetration Tester/Network Security/Nmap Post Port Scans",title:"Nmap Post Port Scans",description:"Nmap #tools",source:"@site/docs/Jr Penetration Tester/Network Security/Nmap Post Port Scans.md",sourceDirName:"Jr Penetration Tester/Network Security",slug:"/Jr Penetration Tester/Network Security/Nmap Post Port Scans",permalink:"/docs/Jr Penetration Tester/Network Security/Nmap Post Port Scans",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"THMSidebar",previous:{title:"Nmap Live Host Discovery",permalink:"/docs/Jr Penetration Tester/Network Security/Nmap Live Host Discovery"},next:{title:"Passive Reconnaissance",permalink:"/docs/Jr Penetration Tester/Network Security/Passive Reconnaissance"}},a={},d=[{value:"Normal",id:"normal",level:2},{value:"Grepable",id:"grepable",level:2},{value:"XML",id:"xml",level:2},{value:"Script Kiddie",id:"script-kiddie",level:2}];function l(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"#Network  #Nmap #tools"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Detect versions of the running services (on all open ports)"}),"\n",(0,n.jsx)(t.li,{children:"Detect the OS based on any signs revealed by the target"}),"\n",(0,n.jsx)(t.li,{children:"Run Nmap\u2019s traceroute"}),"\n",(0,n.jsx)(t.li,{children:"Run select Nmap scripts"}),"\n",(0,n.jsx)(t.li,{children:"Save the scan results in various formats"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{alt:"Nmap",src:s(4366).A+"",width:"642",height:"802"})}),"\n",(0,n.jsx)(t.h1,{id:"service-detection",children:"Service Detection"}),"\n",(0,n.jsxs)(t.p,{children:["Adding ",(0,n.jsx)(t.code,{children:"-sV"})," to your Nmap command will collect and determine service and version information for the open ports. You can control the intensity with ",(0,n.jsx)(t.code,{children:"--version-intensity LEVEL"})," where the level ranges between 0, the lightest, and 9, the most complete. ",(0,n.jsx)(t.code,{children:"-sV --version-light"})," has an intensity of 2, while ",(0,n.jsx)(t.code,{children:"-sV --version-all"})," has an intensity of 9."]}),"\n",(0,n.jsxs)(t.p,{children:["It is important to note that using ",(0,n.jsx)(t.code,{children:"-sV"})," will force Nmap to proceed with the TCP 3-way handshake and establish the connection. The connection establishment is necessary because Nmap cannot discover the version without establishing a connection fully and communicating with the listening service. In other words, stealth SYN scan ",(0,n.jsx)(t.code,{children:"-sS"})," is not possible when ",(0,n.jsx)(t.code,{children:"-sV"})," option is chosen."]}),"\n",(0,n.jsx)(t.h1,{id:"os-detection-and-traceroute",children:"OS Detection and Traceroute"}),"\n",(0,n.jsx)(t.h1,{id:"os-detection",children:"OS Detection"}),"\n",(0,n.jsxs)(t.p,{children:["Nmap can detect the Operating System (OS) based on its behaviour and any telltale signs in its responses. OS detection can be enabled using ",(0,n.jsx)(t.code,{children:"-O"}),"; this is an ",(0,n.jsx)(t.em,{children:"uppercase O"})," as in OS."]}),"\n",(0,n.jsx)(t.p,{children:"The OS detection is very convenient, but many factors might affect its accuracy. First and foremost, Nmap needs to find at least one open and one closed port on the target to make a reliable guess. Furthermore, the guest OS fingerprints might get distorted due to the rising use of virtualization and similar technologies. Therefore, always take the OS version with a grain of salt."}),"\n",(0,n.jsx)(t.h1,{id:"traceroute",children:"Traceroute"}),"\n",(0,n.jsxs)(t.p,{children:["If you want Nmap to find the routers between you and the target, just add ",(0,n.jsx)(t.code,{children:"--traceroute"}),". In the following example, Nmap appended a traceroute to its scan results. Note that Nmap\u2019s traceroute works slightly different than the ",(0,n.jsx)(t.code,{children:"traceroute"})," command found on Linux and macOS or ",(0,n.jsx)(t.code,{children:"tracert"})," found on MS Windows. Standard ",(0,n.jsx)(t.code,{children:"traceroute"})," starts with a packet of low TTL (Time to Live) and keeps increasing until it reaches the target. Nmap\u2019s traceroute starts with a packet of high TTL and keeps decreasing it."]}),"\n",(0,n.jsx)(t.p,{children:"It is worth mentioning that many routers are configured not to send ICMP Time-to-Live exceeded, which would prevent us from discovering their IP addresses."}),"\n",(0,n.jsx)(t.h1,{id:"nmap-scripting-engine-nse",children:"Nmap Scripting Engine (NSE)"}),"\n",(0,n.jsx)(t.p,{children:"A script is a piece of code that does not need to be compiled. In other words, it remains in its original human-readable form and does not need to be converted to machine language. Many programs provide additional functionality via scripts; moreover, scripts make it possible to add custom functionality that did not exist via the built-in commands. Similarly, Nmap provides support for scripts using the Lua language. A part of Nmap, Nmap Scripting Engine (NSE) is a Lua interpreter that allows Nmap to execute Nmap scripts written in Lua language. However, we don\u2019t need to learn Lua to make use of Nmap scripts."}),"\n",(0,n.jsxs)(t.p,{children:["Your Nmap default installation can easily contain close to 600 scripts. Take a look at your Nmap installation folder. On the AttackBox, check the files at ",(0,n.jsx)(t.code,{children:"/usr/share/nmap/scripts"}),", and you will notice that there are hundreds of scripts conveniently named starting with the protocol they target."]}),"\n",(0,n.jsxs)(t.p,{children:["You can specify to use any or a group of these installed scripts; moreover, you can install other user\u2019s scripts and use them for your scans. Let\u2019s begin with the default scripts. You can choose to run the scripts in the default category using ",(0,n.jsx)(t.code,{children:"--script=default"})," or simply adding ",(0,n.jsx)(t.code,{children:"-sC"}),". In addition to ",(0,n.jsx)(t.a,{href:"https://nmap.org/nsedoc/categories/default.html",children:"default"}),", categories include auth, broadcast, brute, default, discovery, dos, exploit, external, fuzzer, intrusive, malware, safe, version, and vuln."]}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Script Category"}),(0,n.jsx)(t.th,{children:"Description"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"auth"})}),(0,n.jsx)(t.td,{children:"Authentication related scripts"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"broadcast"})}),(0,n.jsx)(t.td,{children:"Discover hosts by sending broadcast messages"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"brute"})}),(0,n.jsx)(t.td,{children:"Performs brute-force password auditing against logins"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"default"})}),(0,n.jsxs)(t.td,{children:["Default scripts, same as ",(0,n.jsx)(t.code,{children:"-sC"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"discovery"})}),(0,n.jsx)(t.td,{children:"Retrieve accessible information, such as database tables and DNS names"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"dos"})}),(0,n.jsx)(t.td,{children:"Detects servers vulnerable to Denial of Service (DoS)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"exploit"})}),(0,n.jsx)(t.td,{children:"Attempts to exploit various vulnerable services"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"external"})}),(0,n.jsx)(t.td,{children:"Checks using a third-party service, such as Geoplugin and Virustotal"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"fuzzer"})}),(0,n.jsx)(t.td,{children:"Launch fuzzing attacks"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"intrusive"})}),(0,n.jsx)(t.td,{children:"Intrusive scripts such as brute-force attacks and exploitation"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"malware"})}),(0,n.jsx)(t.td,{children:"Scans for backdoors"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"safe"})}),(0,n.jsx)(t.td,{children:"Safe scripts that won\u2019t crash the target"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"version"})}),(0,n.jsx)(t.td,{children:"Retrieve service versions"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"vuln"})}),(0,n.jsx)(t.td,{children:"Checks for vulnerabilities or exploit vulnerable services"})]})]})]}),"\n",(0,n.jsx)(t.p,{children:"Some scripts belong to more than one category. Moreover, some scripts launch brute-force attacks against services, while others launch DoS attacks and exploit systems. Hence, it is crucial to be careful when selecting scripts to run if you don\u2019t want to crash services or exploit them."}),"\n",(0,n.jsxs)(t.p,{children:["You can also specify the script by name using ",(0,n.jsx)(t.code,{children:'--script "SCRIPT-NAME"'})," or a pattern such as ",(0,n.jsx)(t.code,{children:'--script "ftp*"'}),", which would include ",(0,n.jsx)(t.code,{children:"ftp-brute"}),". If you are unsure what a script does, you can open the script file with a text reader, such as ",(0,n.jsx)(t.code,{children:"less"}),", or a text editor. In the case of ",(0,n.jsx)(t.code,{children:"ftp-brute"}),", it states: \u201cPerforms brute force password auditing against FTP servers.\u201d You have to be careful as some scripts are pretty intrusive. Moreover, some scripts might be for a specific server and, if chosen at random, will waste your time with no benefit. As usual, make sure that you are authorized to launch such tests on the target server."]}),"\n",(0,n.jsx)(t.h1,{id:"saving-the-output",children:"Saving the Output"}),"\n",(0,n.jsx)(t.p,{children:"Whenever you run a Nmap scan, it is only reasonable to save the results in a file. Selecting and adopting a good naming convention for your filenames is also crucial. The number of files can quickly grow and hinder your ability to find a previous scan result. The three main formats are"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Normal"}),"\n",(0,n.jsxs)(t.li,{children:["Grepable (",(0,n.jsx)(t.code,{children:"grep"}),"able)"]}),"\n",(0,n.jsx)(t.li,{children:"XML"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"There is a fourth one that we cannot recommend:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Script Kiddie"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"normal",children:"Normal"}),"\n",(0,n.jsxs)(t.p,{children:["As the name implies, the normal format is similar to the output you get on the screen when scanning a target. You can save your scan in normal format by using ",(0,n.jsx)(t.code,{children:"-oN FILENAME"}),"; N stands for normal."]}),"\n",(0,n.jsx)(t.h2,{id:"grepable",children:"Grepable"}),"\n",(0,n.jsxs)(t.p,{children:["The grepable format has its name from the command ",(0,n.jsx)(t.code,{children:"grep"}),"; grep stands for Global Regular Expression Printer. In simple terms, it makes filtering the scan output for specific keywords or terms efficient. You can save the scan result in grepable format using ",(0,n.jsx)(t.code,{children:"-oG FILENAME"}),". The scan output, displayed above in normal format, is shown in the console below using grepable format. The normal output is 21 lines; however, the grepable output is only 4 lines. The main reason is that Nmap wants to make each line meaningful and complete when the user applies ",(0,n.jsx)(t.code,{children:"grep"}),". As a result, in grepable output, the lines are so long and are not convenient to read compared to normal output."]}),"\n",(0,n.jsxs)(t.p,{children:["An example use of ",(0,n.jsx)(t.code,{children:"grep"})," is ",(0,n.jsx)(t.code,{children:"grep KEYWORD TEXT_FILE"}),"; this command will display all the lines containing the provided keyword."]}),"\n",(0,n.jsx)(t.h2,{id:"xml",children:"XML"}),"\n",(0,n.jsxs)(t.p,{children:["The third format is XML. You can save the scan results in XML format using ",(0,n.jsx)(t.code,{children:"-oX FILENAME"}),". The XML format would be most convenient to process the output in other programs. Conveniently enough, you can save the scan output in all three formats using ",(0,n.jsx)(t.code,{children:"-oA FILENAME"})," to combine ",(0,n.jsx)(t.code,{children:"-oN"}),", ",(0,n.jsx)(t.code,{children:"-oG"}),", and ",(0,n.jsx)(t.code,{children:"-oX"})," for normal, grepable, and XML."]}),"\n",(0,n.jsx)(t.h2,{id:"script-kiddie",children:"Script Kiddie"}),"\n",(0,n.jsxs)(t.p,{children:["A fourth format is script kiddie. You can see that this format is useless if you want to search the output for any interesting keywords or keep the results for future reference. However, you can use it to save the output of the scan ",(0,n.jsx)(t.code,{children:"nmap -sS 127.0.0.1 -oS FILENAME"}),", display the output filename, and look 31337 in front of friends who are not tech-savvy."]}),"\n",(0,n.jsx)(t.h1,{id:"summary",children:"Summary"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"Option"}),(0,n.jsx)(t.th,{children:"Meaning"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-sV"})}),(0,n.jsx)(t.td,{children:"determine service/version info on open ports"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-sV --version-light"})}),(0,n.jsx)(t.td,{children:"try the most likely probes (2)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-sV --version-all"})}),(0,n.jsx)(t.td,{children:"try all available probes (9)"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-O"})}),(0,n.jsx)(t.td,{children:"detect OS"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--traceroute"})}),(0,n.jsx)(t.td,{children:"run traceroute to target"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"--script=SCRIPTS"})}),(0,n.jsx)(t.td,{children:"Nmap scripts to run"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsxs)(t.td,{children:[(0,n.jsx)(t.code,{children:"-sC"})," or ",(0,n.jsx)(t.code,{children:"--script=default"})]}),(0,n.jsx)(t.td,{children:"run default scripts"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-A"})}),(0,n.jsxs)(t.td,{children:["equivalent to ",(0,n.jsx)(t.code,{children:"-sV -O -sC --traceroute"})]})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-oN"})}),(0,n.jsx)(t.td,{children:"save output in normal format"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-oG"})}),(0,n.jsx)(t.td,{children:"save output in grepable format"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-oX"})}),(0,n.jsx)(t.td,{children:"save output in XML format"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:(0,n.jsx)(t.code,{children:"-oA"})}),(0,n.jsx)(t.td,{children:"save output in normal, XML and Grepable formats"})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},4366:(e,t,s)=>{s.d(t,{A:()=>n});const n=s.p+"assets/images/Nmap_Post_Port_Scans_1-92850759a3ea82c35b56ddc8699cef45.png"},8453:(e,t,s)=>{s.d(t,{R:()=>o,x:()=>c});var n=s(6540);const r={},i=n.createContext(r);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);