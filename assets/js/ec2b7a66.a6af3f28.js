"use strict";(self.webpackChunkTHM_Notes=self.webpackChunkTHM_Notes||[]).push([[2667],{7113:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>l});var i=n(4848),r=n(8453);const s={},o="Finding an SSRF",a={id:"Jr Penetration Tester/Introduction to Web Hacking/Intro to SSRF",title:"Intro to SSRF",description:"SSRF stands for Server-Side Request Forgery, which allows a malicious user to cause the webserver to make an additional or edited HTTP request to the resource of the attacker's choosing.",source:"@site/docs/Jr Penetration Tester/Introduction to Web Hacking/Intro to SSRF.md",sourceDirName:"Jr Penetration Tester/Introduction to Web Hacking",slug:"/Jr Penetration Tester/Introduction to Web Hacking/Intro to SSRF",permalink:"/docs/Jr Penetration Tester/Introduction to Web Hacking/Intro to SSRF",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"THMSidebar",previous:{title:"IDOR",permalink:"/docs/Jr Penetration Tester/Introduction to Web Hacking/IDOR"},next:{title:"SQL Injection",permalink:"/docs/Jr Penetration Tester/Introduction to Web Hacking/SQL Injection"}},c={},l=[{value:"Deny List",id:"deny-list",level:2},{value:"Allow List",id:"allow-list",level:2},{value:"Open Redirect",id:"open-redirect",level:2}];function d(e){const t={a:"a",h1:"h1",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:"#Web"}),"\n",(0,i.jsx)(t.p,{children:"SSRF stands for Server-Side Request Forgery, which allows a malicious user to cause the webserver to make an additional or edited HTTP request to the resource of the attacker's choosing."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"regular SSRF"}),"\n",(0,i.jsx)(t.li,{children:"Blind SSRF (nothing return to screen)"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"The result of SSRF:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"Access to unauthorised areas"}),"\n",(0,i.jsx)(t.li,{children:"Access to customer/ organisational data"}),"\n",(0,i.jsx)(t.li,{children:"Ability to Scale to internal networks"}),"\n",(0,i.jsx)(t.li,{children:"Reveal authentication tokens/ credentials"}),"\n"]}),"\n",(0,i.jsx)(t.h1,{id:"finding-an-ssrf",children:"Finding an SSRF"}),"\n",(0,i.jsx)(t.p,{children:"Four potential places of potential SSRF vulnerabilities:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"A full URL is used in a parameter in the address bar"}),"\n",(0,i.jsx)(t.li,{children:"A hidden field in a form"}),"\n",(0,i.jsx)(t.li,{children:"A partial URL such as just the hostname"}),"\n",(0,i.jsx)(t.li,{children:"Only the path of URL"}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["Blind SSRF -> Use an external HTTP logging tool to monitor the request such as ",(0,i.jsx)(t.a,{href:"https://requestbin.com",children:"requestbin"}),", your own HTTP server or Burp Suite's Collaborator client."]}),"\n",(0,i.jsx)(t.h1,{id:"defeating-common-ssrf-defenses",children:"Defeating Common SSRF Defenses"}),"\n",(0,i.jsx)(t.h2,{id:"deny-list",children:"Deny List"}),"\n",(0,i.jsx)(t.p,{children:"A specific endpoint to restrict access is the localhost, which may contain server performance data and further sensitive information. So localhost and 127.0.0.1 are always in deny list. To bypass it, we can use an alternative localhost references such as 0, 0.0.0.0, 0000, 127.1, 127.*.*.*, 2130706433, 017700000001 or subdomian that have a DNS record which resolves to the IP address 127.0.0.1 such as 127.0.0.1.nip.io"}),"\n",(0,i.jsx)(t.p,{children:"In a cloud environment, the IP address 169.254.169.254 should be banned since it contains metadata for the deployed cloud server, which can bypass by registering a subdomain"}),"\n",(0,i.jsx)(t.h2,{id:"allow-list",children:"Allow List"}),"\n",(0,i.jsxs)(t.p,{children:["For example, it can set a rule that a URL used in a parameter must begin with ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.a,{href:"https://website.thm",children:"https://website.thm"})}),", we can bypass it by creating a subdomain such as ",(0,i.jsx)(t.a,{href:"https://website.thm.attackers-domian.thm",children:"https://website.thm.attackers-domian.thm"})]}),"\n",(0,i.jsx)(t.h2,{id:"open-redirect",children:"Open Redirect"}),"\n",(0,i.jsxs)(t.p,{children:["An open redirect is an end point on the server where the website visitors gets automatically redirect to another website address\nThere may a potential SSRF vulnerability with stringent rules which only allow URLs beginning with ",(0,i.jsx)(t.a,{href:"https://website.thm/",children:"https://website.thm/"}),". An attacker could could utilise the above feature to redirect the internal HTTP request to a domain of the attcaker's choice"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(6540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);