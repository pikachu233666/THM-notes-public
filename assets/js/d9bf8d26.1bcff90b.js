"use strict";(self.webpackChunkTHM_Notes=self.webpackChunkTHM_Notes||[]).push([[5073],{9342:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>l});var i=t(4848),s=t(8453);const o={},a="Exploring Command Injection",r={id:"Jr Penetration Tester/Introduction to Web Hacking/Command Injection",title:"Command Injection",description:"It is the abuse of an application's behaviour to execute commands on the operating system, using the same privileges that the application on a device is running.",source:"@site/docs/Jr Penetration Tester/Introduction to Web Hacking/Command Injection.md",sourceDirName:"Jr Penetration Tester/Introduction to Web Hacking",slug:"/Jr Penetration Tester/Introduction to Web Hacking/Command Injection",permalink:"/docs/Jr Penetration Tester/Introduction to Web Hacking/Command Injection",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"THMSidebar",previous:{title:"Authentication Bypass",permalink:"/docs/Jr Penetration Tester/Introduction to Web Hacking/Authentication Bypass"},next:{title:"Content Discovery",permalink:"/docs/Jr Penetration Tester/Introduction to Web Hacking/Content Discovery"}},c={},l=[{value:"Blind command injection",id:"blind-command-injection",level:2},{value:"Verbose command injection",id:"verbose-command-injection",level:2},{value:"Useful payloads",id:"useful-payloads",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"#Web"}),"\n",(0,i.jsx)(n.p,{children:"It is the abuse of an application's behaviour to execute commands on the operating system, using the same privileges that the application on a device is running."}),"\n",(0,i.jsx)(n.p,{children:'Common injection is also often known as "Remote Code Execution (RCE)"'}),"\n",(0,i.jsx)(n.p,{children:"Command injection was one of the top ten vulnerabilities reported by Contrast Security\u2019s AppSec intelligence report in 2019. Moreover, the OWASP framework constantly proposes vulnerabilities of this nature as one of the top ten vulnerabilities of a web application."}),"\n",(0,i.jsx)(n.p,{children:"It happens because applications often use functions in programming languages such as PHP, Python and NodeJS to pass data and to make calls on the machine's operating system."}),"\n",(0,i.jsx)(n.h1,{id:"exploring-command-injection",children:"Exploring Command Injection"}),"\n",(0,i.jsx)(n.p,{children:"It can be detected in mostly by one of the two ways"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Blind command injection"}),"\n",(0,i.jsx)(n.li,{children:"Verbose command injection"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"blind-command-injection",children:"Blind command injection"}),"\n",(0,i.jsxs)(n.p,{children:["It is where there is no direct output from the application when testing payloads.\nWe need to use payloads that cause some time delay, the ",(0,i.jsx)(n.code,{children:"ping"})," and ",(0,i.jsx)(n.code,{children:"sleep"})," commands are significant payloads to test with.\nBesides, we can force some output by using redirection operation such as ",(0,i.jsx)(n.code,{children:">"}),".\nThe ",(0,i.jsx)(n.code,{children:"curl"})," is a great way to test, for example, ",(0,i.jsx)(n.code,{children:"curl\xa0http://vulnerable.app/process.php%3Fsearch%3DThe%20Beatles%3B%20whoami"})]}),"\n",(0,i.jsx)(n.h2,{id:"verbose-command-injection",children:"Verbose command injection"}),"\n",(0,i.jsx)(n.p,{children:"This type of injection is where there is direct feedback from the application once you have tested a payload."}),"\n",(0,i.jsx)(n.h2,{id:"useful-payloads",children:"Useful payloads"}),"\n",(0,i.jsx)(n.p,{children:"Linux"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Payload"})}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Description"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"whoami"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"See what user the application is running under."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ls"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"List the files such as configuration files, environment files (tokens and  application keys), and many more valuable things."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ping"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"This command will invoke the application to hang. This will be useful in testing an application for blind command injection."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"sleep"}),(0,i.jsxs)(n.td,{style:{textAlign:"center"},children:["This is another useful payload in testing an application for blind command injection, where the machine does not have ",(0,i.jsx)(n.code,{children:"ping"})," installed."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"nc"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Netcat can be used to spawn a reverse shell onto the vulnerable  application. You can use this foothold to navigate around the target  machine for other services, files, or potential means of escalating  privileges."})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Windows"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Payload"})}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:(0,i.jsx)(n.strong,{children:"Description"})})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"whoami"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"See what user the application is running under."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"dir"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"List the files such as configuration files, environment files (tokens and  application keys), and many more valuable things."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ping"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"This command will invoke the application to hang. This will be useful in testing an application for blind command injection."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"timeout"}),(0,i.jsxs)(n.td,{style:{textAlign:"center"},children:["This command will also invoke the application to hang. It is also useful for testing an application for blind command injection if the ",(0,i.jsx)(n.code,{children:"ping"})," command is not installed."]})]})]})]}),"\n",(0,i.jsx)(n.h1,{id:"remediating-command-injection",children:"Remediating Command Injection"}),"\n",(0,i.jsx)(n.p,{children:"Everything from minimal use of potentially dangerous functions or  libraries in a programming language to filtering input without relying  on a user\u2019s input."}),"\n",(0,i.jsx)(n.p,{children:"Vulnerable Functions\nIn PHP, many functions interact with the Operating System to execute commands via shell:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Exec"}),"\n",(0,i.jsx)(n.li,{children:"Passthru"}),"\n",(0,i.jsx)(n.li,{children:"System"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Input sanitisation\nSanitising any input from a user that an application uses is a great way to prevent command injection.\nWe can use ",(0,i.jsx)(n.code,{children:"filter_input"})," PHP function to check it."]}),"\n",(0,i.jsxs)(n.p,{children:["Bypassing Filters\nWe can abuse the logic behind an application to bypass these filters. For example, an application may strip out quotation marks; we can instead use the hexadecimal value of this to achieve the same result.\n",(0,i.jsx)(n.code,{children:'$payload = "\\x2f\\x65\\x74\\x63\\x2f\\x70\\x61\\x73\\x73\\x77\\x64"'})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/payloadbox/command-injection-payload-list",children:"command-injection-payload-list"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var i=t(6540);const s={},o=i.createContext(s);function a(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);